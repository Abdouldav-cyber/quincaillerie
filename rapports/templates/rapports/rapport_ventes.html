{% extends 'base.html' %}
{% block titre %}Rapport des Ventes{% endblock %}
{% block contenu %}
    <h2>Rapport des Ventes</h2>
    <form method="get" class="mb-3">
        {{ form.as_p }}
        <button type="submit" class="btn btn-primary">Filtrer</button>
    </form>
    <div class="mb-3">
        <a href="{% url 'exporter_ventes_csv' %}?{{ request.GET.urlencode }}" class="btn btn-primary">Exporter en CSV</a>
        <a href="{% url 'exporter_ventes_pdf' %}?{{ request.GET.urlencode }}" class="btn btn-secondary">Exporter en PDF</a>
        <a href="{% url 'exporter_ventes_excel' %}?{{ request.GET.urlencode }}" class="btn btn-success">Exporter en Excel</a>
    </div>
    <p><strong>Total des ventes :</strong> {{ total_ventes }} FCFA</p>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>ID</th>
                <th>Date</th>
                <th>Client</th>
                <th>Montant Total</th>
                <th>Crédit</th>
            </tr>
        </thead>
        <tbody>
            {% for vente in ventes %}
                <tr>
                    <td>{{ vente.id }}</td>
                    <td>{{ vente.date_vente|date:"d/m/Y H:i" }}</td>
                    <td>{{ vente.client.nom|default:"Anonyme" }}</td>
                    <td>{{ vente.montant_total }} FCFA</td>
                    <td>{{ vente.est_credit|yesno:"Oui,Non" }}</td>
                </tr>
            {% empty %}
                <tr><td colspan="5">Aucune vente trouvée.</td></tr>
            {% endfor %}
        </tbody>
    </table>
{% endblock %}